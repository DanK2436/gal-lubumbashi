<header class="header" role="banner">
    <div class="header__container">
      <!-- Logo -->
      <a href="#/home" class="header__logo">
        <div class="header__logo-img bg-white text-primary d-flex align-center justify-center text-2xl font-bold">
          GAL
        </div>
        <span class="mobile-hidden">GAL</span>
      </a>

      <!-- Navigation -->
      <nav class="nav" role="navigation" aria-label="Navigation principale">
        <ul class="nav__menu">
          <li><a href="/index.html" class="nav__link active" data-i18n="nav.home">Accueil</a></li>
          <li><a href="videos.html" class="nav__link" data-i18n="nav.videos">Vid√©os</a></li>
          <li><a href="formations.html" class="nav__link" data-i18n="nav.formations">Formations</a></li>
          <li><a href="machines.html" class="nav__link" data-i18n="nav.machines">Machines</a></li>
          <li><a href="a-propos.html" class="nav__link" data-i18n="nav.about">√Ä propos</a></li>
          <li><a href="contact.html" class="nav__link" data-i18n="nav.contact">Contact</a></li>
          <li><a href="blog.html" class="nav__link" data-i18n="nav.blog">Blog</a></li>
          <li><a href="faq.html" class="nav__link" data-i18n="nav.faq">FAQ</a></li>
        </ul>

        <!-- Actions -->
        <div class="nav__actions">
          <!-- Language Switcher -->
          <div class="lang-switcher d-flex gap-2">
            <button data-lang="fr" class="btn btn--sm btn--ghost text-light active" aria-label="Fran√ßais">FR</button>
            <button data-lang="en" class="btn btn--sm btn--ghost text-light" aria-label="English">EN</button>
          </div>

          <!-- WhatsApp Button -->
          <button class="btn btn--whatsapp btn--sm mobile-hidden" data-whatsapp aria-label="Contact WhatsApp">
            WhatsApp
          </button>

          <!-- Mobile Menu Toggle -->
          <button class="nav__toggle" aria-label="Menu" aria-expanded="false">
            ‚ò∞
          </button>
        </div>
      </nav>
    </div>
  </header>
<link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/components.css">
  <link rel="stylesheet" href="/css/utilities.css">
  <h1 class="section__title" data-i18n="blog.title">Notre Blog</h1>
<p class="section__subtitle" data-i18n="blog.subtitle">
    Actualit√©s, conseils et bonnes pratiques du monde artisanal
</p>
</div>

<!-- Search & Filter -->
<div class="blog-filters max-w-4xl mx-auto">
    <input type="search" id="search-blog" class="form-input mb-4" placeholder="üîç Rechercher un article..."
        aria-label="Rechercher">

    <div class="blog-tags d-flex justify-center gap-3 flex-wrap">
        <button class="tag tag--active" data-tag="all">Tous</button>
        <button class="tag" data-tag="Technologie">Technologie</button>
        <button class="tag" data-tag="Machines">Machines</button>
        <button class="tag" data-tag="Formation">Formation</button>
        <button class="tag" data-tag="Conseils">Conseils</button>
        <button class="tag" data-tag="S√©curit√©">S√©curit√©</button>
    </div>
</div>
</div>
</section>

<!-- Blog Grid -->
<section class="section">
    <div class="container">
        <div id="blog-grid" class="grid grid--3 mb-12">
            <!-- Loading -->
            <div class="col-span-full text-center">
                <div class="spinner spinner--lg"></div>
                <p class="mt-4 text-muted">Chargement des articles...</p>
            </div>
        </div>

        <!-- No Results -->
        <div id="no-results" class="text-center p-12 d-none">
            <div class="text-6xl mb-4">üìù</div>
            <h3 class="text-2xl mb-3">Aucun article trouv√©</h3>
            <p class="text-muted">Essayez avec d'autres mots-cl√©s</p>
        </div>
    </div>
</section>

<!-- Newsletter CTA -->
<section class="section section--primary text-white">
    <div class="container text-center">
        <h2 class="text-4xl mb-4">Restez inform√© !</h2>
        <p class="text-xl mb-8 opacity-90">
            Recevez nos derniers articles directement dans votre bo√Æte mail
        </p>
        <div class="max-w-md mx-auto">
            <form id="blog-newsletter-form" class="d-flex gap-3">
                <input type="email" id="blog-newsletter-email" class="form-input flex-1" placeholder="Votre email"
                    required>
                <button type="submit" class="btn btn--white">
                    S'abonner
                </button>
            </form>
        </div>
    </div>
</section>
</div>

<!-- Article Modal -->
<div id="article-modal" class="modal" aria-hidden="true" role="dialog">
    <div class="modal__overlay" data-close-modal></div>
    <div class="modal__container modal__container--xl">
        <button class="modal__close" data-close-modal aria-label="Fermer">‚úï</button>
        <div class="modal__content">
            <img id="modal-article-cover" src="" alt="" class="article-cover mb-6">
            <h1 id="modal-article-title" class="text-4xl mb-4"></h1>
            <div class="article-meta mb-6">
                <span id="modal-article-date" class="text-sm text-muted mr-4"></span>
                <div id="modal-article-tags" class="d-inline-flex gap-2"></div>
            </div>
            <div id="modal-article-content" class="article-content"></div>

            <div class="article-footer mt-12 pt-6 border-top">
                <h3 class="text-xl mb-4">Partager cet article</h3>
                <div class="d-flex gap-3">
                    <button class="btn btn--outline btn--sm share-btn" data-share="twitter">
                        Twitter
                    </button>
                    <button class="btn btn--outline btn--sm share-btn" data-share="facebook">
                        Facebook
                    </button>
                    <button class="btn btn--outline btn--sm share-btn" data-share="linkedin">
                        LinkedIn
                    </button>
                    <button class="btn btn--whatsapp btn--sm" data-whatsapp>
                        WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="module">
    import { getBlogPosts, saveNewsletter } from '/js/storage.js';
    import { showToast } from '/js/ui.js';
    import { initWhatsAppButtons } from '/js/whatsapp.js';

    let allPosts = [];
    let filteredPosts = [];
    let currentTag = 'all';
    let searchTerm = '';

    // Format date
    function formatDate(dateString) {
        const date = new Date(dateString);
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        return date.toLocaleDateString('fr-FR', options);
    }

    // Create blog card
    function createBlogCard(post) {
        const card = document.createElement('div');
        card.className = 'card card--hover blog-card';
        card.innerHTML = `
            <div class="card__image">
                <img src="${post.cover}" alt="${post.title}" loading="lazy">
            </div>
            <div class="card__content">
                <div class="mb-3">
                    ${post.tags.map(tag => `<span class="badge badge--outline badge--sm mr-2">${tag}</span>`).join('')}
                </div>
                <h3 class="card__title mb-3">${post.title}</h3>
                <p class="text-muted mb-4">${post.excerpt}</p>
                <div class="d-flex justify-between align-center">
                    <span class="text-sm text-muted">${formatDate(post.date)}</span>
                    <button class="btn btn--primary btn--sm" data-post-id="${post.id}">
                        Lire la suite
                    </button>
                </div>
            </div>
        `;

        // Click handler
        card.querySelector('button').addEventListener('click', () => openArticleModal(post));

        return card;
    }

    // Open article modal
    function openArticleModal(post) {
        const modal = document.getElementById('article-modal');

        document.getElementById('modal-article-cover').src = post.cover;
        document.getElementById('modal-article-cover').alt = post.title;
        document.getElementById('modal-article-title').textContent = post.title;
        document.getElementById('modal-article-date').textContent = formatDate(post.date);
        document.getElementById('modal-article-content').innerHTML = post.content;

        const tagsContainer = document.getElementById('modal-article-tags');
        tagsContainer.innerHTML = post.tags.map(tag =>
            `<span class="badge badge--primary badge--sm">${tag}</span>`
        ).join('');

        modal.classList.add('modal--active');
        modal.setAttribute('aria-hidden', 'false');

        // Share buttons
        document.querySelectorAll('.share-btn').forEach(btn => {
            btn.addEventListener('click', () => shareArticle(post, btn.dataset.share));
        });

        // Update WhatsApp buttons
        initWhatsAppButtons();

        // Close handlers
        modal.querySelectorAll('[data-close-modal]').forEach(el => {
            el.addEventListener('click', () => closeArticleModal());
        });

        // Scroll to top
        modal.querySelector('.modal__content').scrollTop = 0;
    }

    // Close article modal
    function closeArticleModal() {
        const modal = document.getElementById('article-modal');
        modal.classList.remove('modal--active');
        modal.setAttribute('aria-hidden', 'true');
    }

    // Share article
    function shareArticle(post, platform) {
        const url = encodeURIComponent(window.location.href + '#' + post.slug);
        const text = encodeURIComponent(post.title);

        let shareUrl = '';
        switch (platform) {
            case 'twitter':
                shareUrl = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
                break;
            case 'facebook':
                shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                break;
            case 'linkedin':
                shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
                break;
        }

        if (shareUrl) {
            window.open(shareUrl, '_blank', 'width=600,height=400');
        }
    }

    // Load blog posts
    async function loadBlogPosts() {
        try {
            allPosts = await getBlogPosts();
            filteredPosts = [...allPosts];
            renderBlog();
        } catch (error) {
            console.error('Erreur chargement blog:', error);
            showToast('Erreur lors du chargement des articles', 'error');
        }
    }

    // Render blog
    function renderBlog() {
        const grid = document.getElementById('blog-grid');
        const noResults = document.getElementById('no-results');

        if (filteredPosts.length === 0) {
            grid.classList.add('d-none');
            noResults.classList.remove('d-none');
            return;
        }

        grid.classList.remove('d-none');
        noResults.classList.add('d-none');
        grid.innerHTML = '';

        filteredPosts.forEach(post => {
            const card = createBlogCard(post);
            grid.appendChild(card);
        });
    }

    // Apply filters
    function applyFilters() {
        filteredPosts = allPosts.filter(post => {
            const matchesTag = currentTag === 'all' || post.tags.includes(currentTag);
            const matchesSearch = !searchTerm ||
                post.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                post.excerpt.toLowerCase().includes(searchTerm.toLowerCase());

            return matchesTag && matchesSearch;
        });

        renderBlog();
    }

    // Tag filter
    document.querySelectorAll('.tag').forEach(tag => {
        tag.addEventListener('click', () => {
            document.querySelectorAll('.tag').forEach(t => t.classList.remove('tag--active'));
            tag.classList.add('tag--active');
            currentTag = tag.dataset.tag;
            applyFilters();
        });
    });

    // Search
    document.getElementById('search-blog').addEventListener('input', (e) => {
        searchTerm = e.target.value;
        applyFilters();
    });

    // Newsletter form
    document.getElementById('blog-newsletter-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('blog-newsletter-email').value;

        try {
            await saveNewsletter(email);
            showToast('Merci ! Vous √™tes abonn√© √† notre newsletter.', 'success');
            e.target.reset();
        } catch (error) {
            showToast('Erreur lors de l\'inscription', 'error');
        }
    });

    // Close modal on ESC
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeArticleModal();
    });

    // Init
    loadBlogPosts();
</script>

<style>
    .blog-filters {
        margin-bottom: 3rem;
    }

    .tag {
        padding: 0.5rem 1rem;
        border: 2px solid var(--color-gray-300);
        background: white;
        border-radius: 2rem;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .tag:hover {
        border-color: var(--color-primary);
        color: var(--color-primary);
    }

    .tag--active {
        background: var(--color-primary);
        color: white;
        border-color: var(--color-primary);
    }

    .blog-card {
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .blog-card .card__content {
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .blog-card .card__content> :last-child {
        margin-top: auto;
    }

    .article-cover {
        width: 100%;
        height: auto;
        border-radius: 0.5rem;
        object-fit: cover;
    }

    .article-meta {
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--color-gray-200);
    }

    .article-content {
        line-height: 1.8;
        color: var(--color-text);
    }

    .article-content h2 {
        font-size: 1.75rem;
        font-weight: 700;
        margin-top: 2rem;
        margin-bottom: 1rem;
        color: var(--color-text);
    }

    .article-content p {
        margin-bottom: 1rem;
        color: var(--color-text-muted);
    }

    .article-footer {
        border-top: 2px solid var(--color-gray-200);
    }

    .border-top {
        border-top: 1px solid var(--color-gray-200);
    }

    .section--primary {
        background: linear-gradient(135deg, var(--color-primary) 0%, #b91c1c 100%);
    }

    .btn--white {
        background: white;
        color: var(--color-primary);
    }

    .btn--white:hover {
        background: #f5f5f5;
    }

    .badge--outline {
        background: transparent;
        border: 1px solid var(--color-gray-300);
        color: var(--color-text-muted);
    }

    .modal__container--xl {
        max-width: 900px;
    }

    @media (max-width: 768px) {
        .blog-tags {
            justify-content: flex-start;
        }

        .tag {
            font-size: 0.8125rem;
            padding: 0.4rem 0.875rem;
        }
    }
</style>
 <footer class="footer" role="contentinfo">
    <div class="footer__container">
      <div class="footer__grid">
        <!-- √Ä propos -->
        <div class="footer__section">
          <h4 data-i18n="footer.about">√Ä propos</h4>
          <p class="text-muted-light">
            Le Groupement des Artisans de Lubumbashi (GAL) est votre partenaire de confiance pour tous vos besoins en machines, formations et services professionnels.
          </p>
          <div class="footer__social">
            <a href="#" class="footer__social-link" aria-label="Facebook" target="_blank" rel="noopener">
              <span>f</span>
            </a>
            <a href="#" class="footer__social-link" aria-label="LinkedIn" target="_blank" rel="noopener">
              <span>in</span>
            </a>
            <a href="#" class="footer__social-link" aria-label="YouTube" target="_blank" rel="noopener">
              <span>‚ñ∂</span>
            </a>
          </div>
        </div>

        <!-- Liens rapides -->
        <div class="footer__section">
          <h4 data-i18n="footer.quick_links">Liens rapides</h4>
          <ul class="footer__links">
            <li><a href="/index.html" class="footer__link" data-i18n="nav.home">Accueil</a></li>
            <li><a href="videos.html" class="footer__link" data-i18n="nav.videos">Vid√©os</a></li>
            <li><a href="formations.html" class="footer__link" data-i18n="nav.formations">Formations</a></li>
            <li><a href="machines.html" class="footer__link" data-i18n="nav.machines">Machines</a></li>
            <li><a href="blog.html" class="footer__link" data-i18n="nav.blog">Blog</a></li>
            <li><a href="faq.html" class="footer__link" data-i18n="nav.faq">FAQ</a></li>
          </ul>
        </div>

        <!-- Contact -->
        <div class="footer__section">
          <h4 data-i18n="footer.contact">Contact</h4>
          <ul class="footer__links list-none ml-0">
            <li class="text-muted-light mb-3">
              üìç Lubumbashi, Haut-Katanga, RDC
            </li>
            <li class="text-muted-light mb-3">
              üìß contact@gal-lubumbashi.com
            </li>
            <li class="text-muted-light mb-3">
              üì± +243 979 022 998
            </li>
          </ul>
        </div>

        <!-- Newsletter -->
        <div class="footer__section">
          <h4 data-i18n="newsletter.title">Restez inform√©</h4>
          <p class="text-muted-light mb-4" data-i18n="newsletter.subtitle">
            Abonnez-vous √† notre newsletter
          </p>
          <form id="newsletter-form" class="d-flex gap-2">
            <input 
              type="email" 
              class="form-input" 
              placeholder="Votre email"
              data-i18n-placeholder="newsletter.email_placeholder"
              required
              aria-label="Email pour newsletter"
            >
            <button type="submit" class="btn btn--primary" aria-label="S'abonner">
              ‚Üí
            </button>
          </form>
        </div>
      </div>

      <!-- Bottom -->
      <div class="footer__bottom">
        <p>
          ¬© <span id="current-year"></span> GAL - Groupement des Artisans de Lubumbashi.
          <span data-i18n="footer.rights">Tous droits r√©serv√©s</span>.
        </p>
        <p class="mt-2">
          <a href="#" class="footer__link" data-i18n="footer.legal">Mentions l√©gales</a>
          ‚Ä¢
          <a href="#" class="footer__link" data-i18n="footer.privacy">Politique de confidentialit√©</a>
        </p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script type="module" src="/js/app.js"></script>
  
  <!-- Set current year -->
  <script>
    document.getElementById('current-year').textContent = new Date().getFullYear();
  </script>

  <!-- No JavaScript fallback -->
  <noscript>
    <div style="padding: 20px; background: #fee; color: #c00; text-align: center;">
      <strong>JavaScript est requis</strong> pour utiliser ce site web.
      Veuillez activer JavaScript dans votre navigateur.
    </div>
  </noscript>
</body>
</html>
